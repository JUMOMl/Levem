# Анализ безопасности кода проекта Levem
---
## Проверка чек-листа безопасности
- [x] HTTPS использование
- [x] Хеширование паролей с солью
- [x] Защита от SQL-инъекций
- [x] Проверка авторизации
- [x] Валидация входных данных

---

## Ручной анализ безопасности

### 1. Анализ аутентификации

#### ✅ Сильные стороны
- **Хеширование паролей с bcrypt:** В файле `RegistrationAndAuthorization.py` используется библиотека bcrypt для безопасного хеширования паролей с автоматической генерацией соли.
- **Проверка сложности пароля:** Реализована проверка минимальной длины пароля (10 символов) и требований к составу (минимум 2 заглавные буквы, минимум 3 буквы).
- **Валидация email:** Используется регулярное выражение для проверки корректности формата электронной почты.

#### ⚠️ Области для улучшения
- **Отсутствие многофакторной аутентификации:** Система полагается только на пароль
- **Небезопасное хранение сессий:** Текущая сессия пользователя хранится только в памяти без дополнительной защиты

### 2. Анализ авторизации

#### ✅ Сильные стороны
- **Проверка ролей:** В `organizerInterface.py` реализована проверка роли пользователя перед созданием мероприятия
- **Валидация прав доступа:** Проверяется, что только пользователи с ролью 'organizer' могут создавать мероприятия

#### ⚠️ Области для улучшения
- **Ограниченная система ролей:** Все обычные пользователи имеют одинаковые права
- **Отсутствие проверки владельца:** Пользователи могут просматривать и покупать билеты на любые мероприятия без дополнительных проверок

### 3. Анализ защиты от SQL-инъекций

#### ✅ Сильные стороны
- **Использование SQLAlchemy ORM:** Все базовые операции выполняются через ORM, что исключает прямые SQL-инъекции
- **Параметризованные запросы:** Используется метод `.filter()` с параметрами вместо конкатенации строк
- **Безопасные CRUD операции:** В `mydatabase.py` используются стандартные паттерны SQLAlchemy

### 4. Анализ валидации входных данных

#### ✅ Сильные стороны
- **Проверка email:** Регулярное выражение для валидации формата email
- **Проверка пароля:** Валидация сложности пароля
- **Проверка типов:** В `main.py` используется `int()` для конвертации пользовательского ввода
- **Валидация цен:** В `ticketPurchaseInterface.py` проверяется, что цена не отрицательная

#### ⚠️ Области для улучшения
- **Отсутствие защиты от XSS:** Нет экранирования пользовательского ввода для веб-интерфейса
- **Недостаточная валидация дат:** В `organizerInterface.py` предполагается определенный формат дат без явной валидации
- **Отсутствие проверки длины полей:** Нет ограничений на максимальную длину вводимых данных

### 5. Анализ конфигурации безопасности

#### ✅ Сильные стороны
- **Логирование:** Реализовано подробное логирование операций в `RegistrationAndAuthorization.py`
- **Обработка ошибок:** Используются try-catch блоки для обработки исключений базы данных

#### ⚠️ Области для улучшения
- **Небезопасная база данных:** SQLite не подходит для производственного использования без дополнительной защиты
- **Отсутствие HTTPS:** В коде не реализована поддержка защищенного соединения
- **Небезопасная конфигурация логирования:** Логи могут содержать чувствительную информацию

---

## Таблица уязвимостей

| №  | Тип уязвимости | Файл | Строка | Описание | Уровень риска | Предлагаемое решение |
|----|----------------|------|---------|----------|---------------|----------------------|
| 1 | Небезопасное хранение сессий | main.py | 9-27 | Сессии пользователей хранятся только в памяти | MEDIUM | Реализовать защищенное хранение сессий с истечением срока действия |
| 2 | Недостаточная валидация входных данных | organizerInterface.py | 48-49 | Отсутствует проверка формата дат | LOW | Добавить строгую валидацию формата и диапазона дат |
| 3 | Отсутствие поддержки HTTPS | Все файлы | - | Нет реализации защищенного соединения | HIGH | Добавить поддержку HTTPS и принудительное перенаправление |
| 4 | Недостаточная система авторизации | ticketPurchaseInterface.py | 56-74 | Все пользователи имеют одинаковые права доступа | LOW | Реализовать детальную систему прав доступа |
| 5 | Небезопасное логирование | RegistrationAndAuthorization.py | 17-23 | Логи могут содержать чувствительную информацию | LOW | Фильтровать конфиденциальные данные из логов |

---
